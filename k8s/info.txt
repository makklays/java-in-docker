
#
minikube start --driver=docker
eval $(minikube docker-env)
eval $(minikube -p minikube docker-env) // —ç—Ç–æ –∑–∞–ø—É—Å–∫–∞—Ç—å

# –°–æ–±—Ä–∞—Ç—å jar —Ñ–∞–π–ª
mvn clean package -DskipTests
mvn clean install -DskipTests // –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–π

# –û–±–Ω–æ–≤–∏—Ç—å/–æ—Ç–ø—Ä–∞–≤–∏—Ç—å jar —Ñ–∞–π–ª –≤ kubernetes
docker build -t javaindocker:1.0 .

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
kubectl apply -f k8s/mysql-deployment.yaml
kubectl apply -f k8s/mysql-service.yaml

kubectl apply -f k8s/myapp-k8s-deployment.yaml
kubectl apply -f k8s/myapp-k8s-service.yaml

kubectl apply -f k8s/zookeeper-deployment.yaml
kubectl apply -f k8s/rabit-deployment.yaml
kubectl apply -f k8s/kafka-deployment.yaml // –∫–∞—Ñ–∫–∞ –Ω–µ —Å—Ç–∞–Ω–µ—Ç –±–µ–∑ zookeper

# —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π pod myapp
kubectl delete pod myapp-848fffc9ff-npxrn

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–¥, —á—Ç–æ–±—ã –æ–Ω –≤–∑—è–ª –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
kubectl rollout restart deployment myapp

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Pod-—ã –æ–±–Ω–æ–≤–∏–ª–∏—Å—å
kubectl rollout status deployment/myapp
kubectl get pods

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∞ –∏ –ª–æ–≥–∏:
kubectl get pods
kubectl logs -f <–∏–º—è_pod_—Å_myapp>

#
minikube service java-app-service

minikube service myapp-service
|-----------|---------------|-------------|---------------------------|
| NAMESPACE |     NAME      | TARGET PORT |            URL            |
|-----------|---------------|-------------|---------------------------|
| default   | myapp-service |          80 | http://192.168.49.2:30080 |
|-----------|---------------|-------------|---------------------------|
üéâ  Opening service default/myapp-service in default browser...

#
kubectl  port-forward service/myapp-service 8080:80


#########################################
# –ï—Å–ª–∏ –æ–±–Ω–æ–≤–∏–ª–∏ java —Ñ–∞–π–ª—ã:
üí° –ò—Ç–æ–≥ (–ø–æ—à–∞–≥–æ–≤–æ):
    mvn clean install -DskipTests

    docker build -t java-in-docker:1.0 . (–∏–ª–∏ —Å –Ω–æ–≤—ã–º —Ç–µ–≥–æ–º 1.1)
    –∏–ª–∏
    eval $(minikube -p minikube docker-env)  (-p - —ç—Ç–æ –ø—Ä–æ—Ñ–∏–ª—å minikube. –û–Ω –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏)
    eval $(minikube docker-env) (–Ω–µ –∑–∞–±—ã–≤–∞–µ–º —á—Ç–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–Ω—É—Ç—Ä–∏ minikube)
    docker build -t java-in-docker:1.0 .

    kubectl rollout restart deployment myapp (–∏–ª–∏ apply -f)
    kubectl get pods –∏ kubectl logs

