
#
minikube start --driver=docker
eval $(minikube docker-env)
eval $(minikube -p minikube docker-env) // это запускать

# Собрать jar файл
mvn clean package -DskipTests
mvn clean install -DskipTests // более надежный

# Обновить/отправить jar файл в kubernetes
docker build -t javaindocker:1.0 .
docker push javaindocker:1.0

# Применить обновления
kubectl apply -f k8s/mysql-deployment.yaml
kubectl apply -f k8s/mysql-service.yaml

kubectl apply -f k8s/myapp-k8s-deployment.yaml
kubectl apply -f k8s/myapp-k8s-service.yaml

# Перезапустить под, чтобы он взял новые переменные окружения:
kubectl rollout restart deployment myapp

# Проверить что Pod-ы обновились
kubectl rollout status deployment/myapp
kubectl get pods

# Проверить статус пода и логи:
kubectl get pods
kubectl logs -f <имя_pod_с_myapp>

